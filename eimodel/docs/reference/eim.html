<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>An R6 Class for estimating an probability matrix from an R x C ecological inference problem. — eim • eimodel</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="An R6 Class for estimating an probability matrix from an R x C ecological inference problem. — eim"><meta property="og:description" content='This class implements an EM algorithm using different methods to approximate the E-step, such as "Multinomial", "Hit and Run", "MVN CDF", "MVN PDF", and "Exact".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eimodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DanielHermosilla/ecological-inference-elections/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>An R6 Class for estimating an probability matrix from an R x C ecological inference problem.</h1>

    <div class="hidden name"><code>eim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This class implements an EM algorithm using different methods to approximate the E-step, such as <code>"Multinomial"</code>, <code>"Hit and Run"</code>, <code>"MVN CDF"</code>, <code>"MVN PDF"</code>, and <code>"Exact"</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'eim'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eim'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'eim'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sd.eim</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="note">
    <h2>Note</h2>
    <p>Precomputing can eventually accelerate the computation time of the Expectation-Maximization algorithm.</p>
<p>The <code>$compute, $bootstrap, $print</code> and <code>$summary</code> methods can also be called as an S3 method with <code>predict(), sd(), print()</code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Thraves, C. and Ubilla, P.: 'Fast Ecological Inference Algorithm for the R×C Case'</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charles Thraves, Pablo Ubilla</p>
    </div>
    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><table class="table table"><tr><td><code>X</code> <em>(matrix)</em></td><td>An (b x c) matrix with the observed results of the candidate votes (c)</td></tr><tr><td></td><td>for each ballot box (b). Provided manually or loaded from JSON.</td></tr><tr><td></td><td><code>W</code> <em>(matrix)</em></td></tr><tr><td>An (b x g) matrix with the observed results of the demographic group</td><td></td></tr><tr><td>votes (g) for each ballot box (b). Provided manually or loaded from JSON.</td><td></td></tr><tr><td><code>method</code> <em>(character)</em></td><td>A string indicating the EM method. One of: <code>"Multinomial"</code>, <code>"Hit and Run"</code>,</td></tr><tr><td></td><td><code>"MVN CDF"</code>,
<code>"MVN PDF"</code>, or <code>"Exact"</code>.</td></tr><tr><td></td><td><code>probability</code> <em>(matrix)</em></td></tr><tr><td>An (g x c) matrix that will store the final estimated probabilities of a given</td><td></td></tr><tr><td>group (g) voting for a candidate (c).</td><td></td></tr><tr><td><code>logLikelihood</code> <em>(numeric)</em></td><td>A numeric vector that will store the log-likelihood values over all iterations</td></tr><tr><td></td><td>of the Expectation-Maximization algorithm.</td></tr><tr><td></td><td><code>total_iterations</code> <em>(integer(1))</em></td></tr><tr><td>An integer indicating the total number of iterations performed by the</td><td></td></tr><tr><td>Expectation-Maximization algorithm.</td><td></td></tr><tr><td><code>total_time</code> <em>(numeric(1))</em></td><td>The time taken by the EM algorithm.</td></tr><tr><td></td><td><code>finish_state</code> <em>(character)</em></td></tr><tr><td>The reason for the algorithm's termination. It can be either</td><td></td></tr><tr><td>"Maximum iterations", "Log-likelihood decrease", "Convergence",</td><td></td></tr></table><p></p></div>
    </div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    <p></p><div class="r6-active-bindings"><table class="table table"><tr><td><code>samples</code> <em>(integer(1))</em></td><td>Active variable to show the <code>Hit and Run</code> samples if and</td></tr><tr><td></td><td>only if the method is <code>"Hit and Run"</code>.</td></tr><tr><td></td><td><code>step_size</code> <em>(integer(1))</em></td></tr><tr><td>Active variable to show the <code>Hit and Run</code> step size if and</td><td></td></tr><tr><td>only if the method is <code>"Hit and Run"</code>.</td><td></td></tr><tr><td><code>multivariate_method</code> <em>(character)</em></td><td>Active variable to show the method used to estimate</td></tr><tr><td></td><td>the Multivariate
Normal CDF, if and only if <code>self$method</code> is</td></tr><tr><td></td><td><code>"MVN CDF"</code>.</td></tr><tr><td></td><td><code>multivariate_error</code> <em>(numeric(1))</em></td></tr><tr><td>Active variable to show the error threshold for the Monte Carlo</td><td></td></tr><tr><td>simulation of the Multivariate Normal CDF.</td><td></td></tr><tr><td><code>multivariate_iterations</code> <em>(numeric(1))</em></td><td>Active variable to show the number of iterations for the Monte</td></tr><tr><td></td><td>Carlo simulation of the Multivariate Normal CDF.</td></tr><tr><td></td><td><code>sd</code> <em>(matrix)</em></td></tr><tr><td>Active variable to show an estimate of the probability standard</td><td></td></tr></table><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-eim-new"><code>eim$new()</code></a></p></li>
<li><p><a href="#method-eim-precompute"><code>eim$precompute()</code></a></p></li>
<li><p><a href="#method-eim-compute"><code>eim$compute()</code></a></p></li>
<li><p><a href="#method-eim-bootstrap"><code>eim$bootstrap()</code></a></p></li>
<li><p><a href="#method-eim-print"><code>eim$print()</code></a></p></li>
<li><p><a href="#method-eim-summary"><code>eim$summary()</code></a></p></li>
<li><p><a href="#method-eim-save_results"><code>eim$save_results()</code></a></p></li>
<li><p><a href="#method-eim-clone"><code>eim$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-eim-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates the object by defining the X and W matrix attributes.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/eim.html">eim</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>X <span class="op">=</span> <span class="cn">NULL</span>, W <span class="op">=</span> <span class="cn">NULL</span>, json_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><table class="table table"><tr><td><code>X</code> <em>(matrix)</em></td><td>A matrix (c x b) of observed candidate votes per ballot box (b)</td></tr><tr><td></td><td>(optional; required if <code>json_path</code> is <code>NULL</code>).</td></tr><tr><td></td><td><code>W</code> <em>(matrix)</em></td></tr><tr><td>A matrix (b x g) of observed demographic group votes per</td><td></td></tr><tr><td>ballot box (b) (optional; required if <code>json_path</code> is <code>NULL</code>).</td><td></td></tr><tr><td><code>json_path</code> <em>(character)</em></td><td>A string containing a path to a JSON file with "X" and "W"</td></tr><tr><td></td><td>matrices. (optional; required if <code>X</code> or <code>W</code> are <code>NULL</code>)</td></tr></table><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>An initialized eim object.</p>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code># Example 1: Create a eim object from a matrix
model &lt;- eim$new(X = matrix(1:9, 3, 3), W = matrix(1:9, 3, 3))

# Example 2: Create a eim object from a JSON file
\dontrun{
model2 &lt;- eim$new(json_path = "a/file/path/to/a/file.json")
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-eim-precompute"></a><div class="section">
<h3 id="method-precompute-">Method <code>precompute()</code><a class="anchor" aria-label="anchor" href="#method-precompute-"></a></h3>
<p>Calculates the EM-independent variables for the <code>Hit and Run</code> and <code>Exact</code> methods.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">precompute</span><span class="op">(</span><span class="va">method</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><table class="table table"><tr><td><code>method</code> <em>(character)</em></td><td>The method for precomputing. Options:</td></tr><tr><td></td><td><code>"Hit and Run"</code> or <code>"Exact"</code>.</td></tr><tr><td></td><td><code>...</code></td></tr><tr><td>Additional arguments required by specific methods:</td><td></td></tr><tr><td><strong>"Hit and Run" Method:</strong></td><td></td></tr><tr><td></td><td><code>step_size</code> <em>(integer(1))</em></td></tr><tr><td>The step size (M) for the Hit and Run algorithm.</td><td></td></tr><tr><td>Must be a positive integer.</td><td></td></tr><tr><td><code>samples</code> <em>(integer(1))</em></td><td>The number of samples (S) to generate. Must be an</td></tr><tr><td></td><td>integer.</td></tr></table><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>The modified eim object (for method chaining). Updates are made on the C internal memory.</p>
</div>
<div class="section">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Example 1: Precompute the Hit and Run method</span></span>
<span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/eim.html">eim</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">precompute</span><span class="op">(</span><span class="st">"Hit and Run"</span>,</span>
<span>          step_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>          samples <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span>
<span><span class="co"># Changes are made to the C internals API</span></span>
<span></span>
<span><span class="co"># Example 2: Precompute the Exact method</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">precompute</span><span class="op">(</span><span class="st">"Exact"</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-eim-compute"></a><div class="section">
<h3 id="method-compute-">Method <code>compute()</code><a class="anchor" aria-label="anchor" href="#method-compute-"></a></h3>
<p>Executes the Expectation-Maximization (EM) algorithm based on the selected method. Additional parameters may be required depending on the method.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"Multinomial"</span>,</span>
<span>  probability_method <span class="op">=</span> <span class="st">"Group proportional"</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  maximum_time <span class="op">=</span> <span class="fl">1440</span>,</span>
<span>  stopping_threshold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><table class="table table"><tr><td><code>method</code> <em>(character)</em></td><td>The method for estimating the</td></tr><tr><td></td><td>Expectation-Maximization (EM) algorithm.</td></tr><tr><td></td><td>Options:
<code>"Multinomial"</code>, <code>"MVN CDF"</code>,</td></tr><tr><td></td><td><code>"MVN PDF"</code>, <code>"Hit and Run"</code>,</td></tr><tr><td></td><td>and <code>"Exact"</code></td></tr><tr><td></td><td>(default: <code>"Multinomial"</code>).</td></tr><tr><td></td><td><code>probability_method</code> <em>(character)</em></td></tr><tr><td>The method for obtaining the initial</td><td></td></tr><tr><td>probability. Options: <code>"Group proportional"</code>,</td><td></td></tr><tr><td><code>"Proportional"</code>, or <code>"Uniform"</code>.</td><td></td></tr><tr><td>(default: <code>"Group proportional"</code>).</td><td></td></tr><tr><td><code>iterations</code> <em>(integer(1))</em></td><td>The maximum number of iterations to</td></tr><tr><td></td><td>perform on the EM algorithm.</td></tr><tr><td></td><td>(default: <code>1000</code>).</td></tr><tr><td></td><td><code>maximum_time</code> <em>(integer(1))</em></td></tr><tr><td>The maximum time (in minutes) that the</td><td></td></tr><tr><td>algorithm will  iterate. (default: <code>1440</code>).</td><td></td></tr><tr><td><code>stopping_threshold</code> <em>(numeric(1))</em></td><td>The minimum difference between successive</td></tr><tr><td></td><td>probabilities for stopping the iterations.</td></tr><tr><td></td><td>(default: <code>0.001</code>).</td></tr><tr><td></td><td><code>verbose</code> <em>(boolean(1))</em></td></tr><tr><td>A boolean indicating whether to print</td><td></td></tr><tr><td>informative messages while iterating.</td><td></td></tr><tr><td>(default: <code>FALSE</code>).</td><td></td></tr><tr><td><code>...</code></td><td>Additional arguments required by specific</td></tr><tr><td></td><td>methods:</td></tr><tr><td></td><td><strong>"Hit and Run" Method:</strong></td></tr><tr><td></td><td><code>step_size</code> <em>(integer(1))</em>:</td></tr><tr><td>The step size (M) for the Hit and Run</td><td></td></tr><tr><td>algorithm.</td><td></td></tr><tr><td><code>samples</code> <em>(integer(1))</em>:</td><td>The number of samples (S) to generate.</td></tr><tr><td></td><td><strong>"MVN CDF" Method:</strong></td></tr><tr><td></td><td><code>multivariate_method</code> <em>(character)</em>:</td></tr><tr><td>The integration method. Can be chosen</td><td></td></tr><tr><td>between <code>"Genz"</code> and <code>"Genz2"</code>. Default is</td><td></td></tr><tr><td><code>"Genz2"</code>.</td><td></td></tr><tr><td><code>multivariate_error</code> <em>(numeric(1))</em>:</td><td>The integration error threshold. Default is</td></tr><tr><td></td><td><code>1e-6</code>.</td></tr><tr><td></td><td><code>multivariate_iterations</code> <em>(integer(1))</em>:</td></tr><tr><td>The number of Monte Carlo iterations.</td><td></td></tr></table><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>The modified eim object (for method chaining).</p>
</div>
<div class="section">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code># Example 1: Compute the Expectation-Maximization with default values

simulations &lt;- simulate_elections(num_ballots = 20,
				num_candidates = 5,
				num_groups = 3,
				ballot_voters = rep(100, 20))

model &lt;- eim$new(simulations$X, simulations$W)
model$compute() # Retrieves the object with updated attributes

# Example 2: Compute the Expectation-Maximization for the Hit and Run method
\donttest{
	model$compute(method = "Hit and Run",
					step_size = 3000,
					samples = 1000)
	}

# Example 3: Omit arguments to the Hit and Run method
\dontrun{
	model$compute(method = "Hit and Run",
					step_size = 3000)
	# Error; must supply the samples parameter as well
	}

# Example 4: Run the MVN CDF with default values
model$compute(method = "MVN CDF")

# Example 5: Run an Exact estimation with user-defined parameters
model$compute(method = "Exact",
				probability_method = "Uniform",
 			iterations = 5,
				stopping_threshold = 1e-3)
# Verbose was omitted
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-eim-bootstrap"></a><div class="section">
<h3 id="method-bootstrap-">Method <code>bootstrap()</code><a class="anchor" aria-label="anchor" href="#method-bootstrap-"></a></h3>
<p>Runs a bootstrap algorithm to estimate the <strong>standard deviation</strong> of probabilities.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">bootstrap</span><span class="op">(</span></span>
<span>  <span class="va">bootstrap_iterations</span>,</span>
<span>  <span class="va">ballot_boxes</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Multinomial"</span>,</span>
<span>  probability_method <span class="op">=</span> <span class="st">"Group proportional"</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  stopping_threshold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><table class="table table"><tr><td><code>bootstrap_iterations</code> <em>(integer(1))</em></td><td>The number of EM computations.</td></tr><tr><td></td><td><code>ballot_boxes</code> <em>(integer(1))</em></td></tr><tr><td>The number of ballot boxes to use</td><td></td></tr><tr><td>as a sample. It must be</td><td></td></tr><tr><td>strictly less than the total</td><td></td></tr><tr><td>number of ballot boxes.</td><td></td></tr><tr><td><em>Arguments for calling the</em> <code>$compute()</code></td><td><em>method</em>:</td></tr><tr><td></td><td><code>method</code> <em>(character)</em></td></tr><tr><td>The method for estimating the</td><td></td></tr><tr><td>Expectation-Maximization (EM) algorithm.</td><td></td></tr><tr><td>Options:
<code>"Multinomial"</code>, <code>"MVN CDF"</code>,</td><td></td></tr><tr><td><code>"MVN PDF"</code>, <code>"Hit and Run"</code>,</td><td></td></tr><tr><td>and <code>"Exact"</code></td><td></td></tr><tr><td>(default: <code>"Multinomial"</code>).</td><td></td></tr><tr><td><code>probability_method</code> <em>(character)</em></td><td>The method for obtaining the initial</td></tr><tr><td></td><td>probability. Options: <code>"Group proportional"</code>,</td></tr><tr><td></td><td><code>"Proportional"</code>, or <code>"Uniform"</code>.</td></tr><tr><td></td><td>(default: <code>"Group proportional"</code>).</td></tr><tr><td></td><td><code>iterations</code> <em>(integer(1))</em></td></tr><tr><td>The maximum number of iterations to</td><td></td></tr><tr><td>perform on the EM algorithm.</td><td></td></tr><tr><td>(default: <code>1000</code>).</td><td></td></tr><tr><td><code>maximum_time</code> <em>(integer(1))</em></td><td>The maximum time (in minutes) that the</td></tr><tr><td></td><td>algorithm will  iterate. (default: <code>1440</code>).</td></tr><tr><td></td><td><code>stopping_threshold</code> <em>(numeric(1))</em></td></tr><tr><td>The minimum difference between successive</td><td></td></tr><tr><td>probabilities for stopping the iterations.</td><td></td></tr><tr><td>(default: <code>0.001</code>).</td><td></td></tr><tr><td><code>verbose</code> <em>(boolean(1))</em></td><td>A boolean indicating whether to print</td></tr><tr><td></td><td>informative messages while iterating.</td></tr><tr><td></td><td>(default: <code>FALSE</code>).</td></tr><tr><td></td><td><code>...</code></td></tr><tr><td>Additional arguments required by specific</td><td></td></tr><tr><td>methods:</td><td></td></tr><tr><td><strong>"Hit and Run" Method:</strong></td><td></td></tr><tr><td><code>step_size</code> <em>(integer(1))</em>:</td><td>The step size (M) for the Hit and Run</td></tr><tr><td></td><td>algorithm.</td></tr><tr><td></td><td><code>samples</code> <em>(integer(1))</em>:</td></tr><tr><td>The number of samples (S) to generate.</td><td></td></tr><tr><td><strong>"MVN CDF" Method:</strong></td><td></td></tr><tr><td><code>multivariate_method</code> <em>(character)</em>:</td><td>The integration method. Can be chosen</td></tr><tr><td></td><td>between <code>"Genz"</code> and <code>"Genz2"</code>. Default is</td></tr><tr><td></td><td><code>"Genz2"</code>.</td></tr><tr><td></td><td><code>multivariate_error</code> <em>(numeric(1))</em>:</td></tr><tr><td>The integration error threshold. Default is</td><td></td></tr><tr><td><code>1e-6</code>.</td><td></td></tr><tr><td><code>multivariate_iterations</code> <em>(integer(1))</em>:</td><td>The number of Monte Carlo iterations.</td></tr><tr><td></td><td>Default is <code>5000</code>.</td></tr></table><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>The modified eim object, under the field <code>$sd</code>.</p>
</div>
<div class="section">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span></span>
<span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/eim.html">eim</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">bootstrap</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">sd</span> <span class="co"># An estimate of the standard deviation of the probabilities.</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-eim-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Depending on the state of the algorithm (computed or not), it prints a message with its most relevant parameters.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>The object itself (for method chaining).</p>
</div>
<div class="section">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span></span>
<span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/eim.html">eim</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># Prints the X and W matrices.</span></span>
<span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># Prints the X and W matrices along with the EM results.</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-eim-summary"></a><div class="section">
<h3 id="method-summary-">Method <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code><a class="anchor" aria-label="anchor" href="#method-summary-"></a></h3>
<p>Shows, in the form of a list, a selection of the most important attributes. It retrieves the method, number of candidates, ballots, and groups, as well as the principal results of the EM algorithm.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p><em>(list)</em> A list with the <code>method, candidates, ballots, groups, probabilities, log-likelihood, finish_state</code> and <code>standard deviation.</code></p>
</div>
<div class="section">
<h4 id="examples-5">Examples<a class="anchor" aria-label="anchor" href="#examples-5"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span></span>
<span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        num_candidates <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        num_groups <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/eim.html">eim</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span>
<span><span class="va">a_list</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">a_list</span><span class="op">$</span><span class="va">method</span> <span class="co"># Not computed yet</span></span>
<span><span class="va">a_list</span><span class="op">$</span><span class="va">groups</span> <span class="co"># 2</span></span>
<span><span class="va">a_list</span><span class="op">$</span><span class="va">ballots</span> <span class="co"># 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">a_list</span><span class="op">)</span></span>
<span><span class="co"># "candidates" "groups" "ballots" "method" "probabilities"</span></span>
<span><span class="co"># "logLikelihood" "finish_state" "sd"</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-eim-save_results"></a><div class="section">
<h3 id="method-save-results-">Method <code>save_results()</code><a class="anchor" aria-label="anchor" href="#method-save-results-"></a></h3>
<p>Saves the current eim object to a specified file. The results can be saved in:</p><ul><li><p><strong>RDS (Binary format):</strong> Preserves object structure for future use in R. <br><br></p></li>
<li><p><strong>JSON:</strong> Saves model data in a human-readable format. <br><br></p></li>
<li><p><strong>CSV:</strong> Saves the probability matrix in a tabular format.</p></li>
</ul><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><table class="table table"><tr><td><code>filename</code> <em>(character)</em></td><td>The file name where the results should be saved,</td></tr><tr><td></td><td>including its extension.
The file</td></tr><tr><td></td><td>extension determines the format:</td></tr><tr><td></td><td><var>*.rds</var></td></tr><tr><td>Saves as <code class="file">RDS</code> (default, binary format).</td><td></td></tr><tr><td><var>*.json</var></td><td>Saves as <code class="file">JSON</code> (readable and shareable).</td></tr><tr><td></td><td><var>*.csv</var></td></tr></table></div><p></p></div>
</div>
<div class="section">
<h3 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h3>
<p>The modified eim object (for method chaining).</p>
</div>
<div class="section">
<h3 id="examples-6">Examples<a class="anchor" aria-label="anchor" href="#examples-6"></a></h3>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span></span>
<span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span>
<span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/eim.html">eim</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="st">"results.rds"</span><span class="op">)</span>  <span class="co"># Save as RDS</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="st">"results.json"</span><span class="op">)</span> <span class="co"># Save as JSON</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="st">"results.csv"</span><span class="op">)</span>  <span class="co"># Save the final probability matrix as CSV</span></span></code></pre></div><p></p></div>
</div>

<p></p><hr><a id="method-eim-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class can be cloned using this method.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">eim</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><table class="table table"><tr><td><code>deep</code> <em>(bool(1))</em></td><td>Whether to make a deep clone.</td></tr></table><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$new`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Create a eim object from a matrix</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Create a eim object from a JSON file</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>json_path <span class="op">=</span> <span class="st">"a/file/path/to/a/file.json"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$precompute`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Precompute the Hit and Run method</span></span></span>
<span class="r-in"><span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">precompute</span><span class="op">(</span><span class="st">"Hit and Run"</span>,</span></span>
<span class="r-in"><span>          step_size <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>          samples <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Precomputing the Hit and Run method</span>
<span class="r-in"><span><span class="co"># Changes are made to the C internals API</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Precompute the Exact method</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">precompute</span><span class="op">(</span><span class="st">"Exact"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Precomputing the Exact method</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$compute`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Compute the Expectation-Maximization </span></span></span>
<span class="r-in"><span><span class="co"># with default values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span> <span class="co"># Retrieves the object with updated </span></span></span>
<span class="r-in"><span><span class="co"># attributes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Compute the Expectation-Maximization </span></span></span>
<span class="r-in"><span><span class="co"># for the Hit and Run method</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span>  <span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Hit and Run"</span>,</span></span>
<span class="r-in"><span>          step_size <span class="op">=</span> <span class="fl">3000</span>,</span></span>
<span class="r-in"><span>          samples <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Omit arguments to the Hit and Run </span></span></span>
<span class="r-in"><span><span class="co"># method</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Hit and Run"</span>,</span></span>
<span class="r-in"><span>          step_size <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Error; must supply the samples parameter as well</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: Run the MVN CDF with default values</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"MVN CDF"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5: Run an Exact estimation with </span></span></span>
<span class="r-in"><span><span class="co"># user-defined parameters</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Exact"</span>,</span></span>
<span class="r-in"><span>        probability_method <span class="op">=</span> <span class="st">"Uniform"</span>,</span></span>
<span class="r-in"><span>       iterations <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        stopping_threshold <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Verbose was omitted</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$bootstrap`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>X <span class="op">=</span> <span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, W <span class="op">=</span> <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">bootstrap</span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">sd</span> <span class="co"># An estimate of the probabilities' standard </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]       [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.04800395 0.05681623 0.01749571 0.017243044 0.003316897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.02954469 0.03514758 0.03982698 0.020104261 0.017494917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.02139005 0.03856379 0.01917266 0.007544839 0.024901741</span>
<span class="r-in"><span><span class="co"># deviation.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$print`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># Prints the X and W matrices.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eim ecological inference model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Candidate matrix (X) [b x c]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   32   23   19   15   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   32   17   32   10    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   30   17   26    9   18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   35   17   23   11   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   29   17   28   11   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group matrix (W) [b x g]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   69   16   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   70   15   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   74   13   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   65   18   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   60   18   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="co"># Prints the X and W matrices along with </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eim ecological inference model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Candidate matrix (X) [b x c]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   32   23   19   15   11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   32   17   32   10    9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   30   17   26    9   18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   35   17   23   11   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   29   17   28   11   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group matrix (W) [b x g]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   69   16   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   70   15   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   74   13   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   65   18   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]   60   18   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated probability [g x c]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]       [,3]       [,4]       [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.45769715 0.1022744 0.24631703 0.08282288 0.11088857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.04050710 0.6067338 0.02557169 0.26854714 0.05864029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.02915878 0.1348679 0.52309578 0.05962236 0.25325517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:	 Multinomial </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total Iterations:	 22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total Time (s):	 6.5e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood:	 -22.76561</span>
<span class="r-in"><span><span class="co"># the EM results.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$summary`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        num_candidates <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        num_groups <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_list</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a_list</span><span class="op">$</span><span class="va">method</span> <span class="co"># Not computed yet</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Not computed yet"</span>
<span class="r-in"><span><span class="va">a_list</span><span class="op">$</span><span class="va">groups</span> <span class="co"># 2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span><span class="va">a_list</span><span class="op">$</span><span class="va">ballots</span> <span class="co"># 5</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">a_list</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "candidates"    "groups"        "ballots"       "method"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "probabilities" "logLikelihood" "finish_state"  "sd"           </span>
<span class="r-in"><span><span class="co"># "candidates" "groups" "ballots" "method" "probabilities" </span></span></span>
<span class="r-in"><span><span class="co"># "logLikelihood" "finish_state" "sd"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `eim$save_results`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_elections.html">simulate_elections</a></span><span class="op">(</span>num_ballots <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>        num_candidates <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>        num_groups <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>        ballot_voters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">eim</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simulations</span><span class="op">$</span><span class="va">X</span>, <span class="va">simulations</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">compute</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="st">"results.rds"</span><span class="op">)</span>  <span class="co"># Save as RDS</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Results saved as RDS: results.rds</span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="st">"results.json"</span><span class="op">)</span> <span class="co"># Save as JSON</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Results saved as JSON: results.json</span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="fu">save_results</span><span class="op">(</span><span class="st">"results.csv"</span><span class="op">)</span>  <span class="co"># Save the final </span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Probability matrix saved as CSV: results.csv</span>
<span class="r-in"><span><span class="co"># probability matrix as CSV</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Hermosilla.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

