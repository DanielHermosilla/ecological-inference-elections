<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>S3 Object for the Expectation-Maximization Algorithm — eim • fastei</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="S3 Object for the Expectation-Maximization Algorithm — eim"><meta name="description" content="This constructor creates an eim S3 object, either by using matrices
X and W directly or by reading them from a JSON file. Each
eim object encapsulates the data (votes for candidates and demographic
groups) required by the underlying Expectation-Maximization algorithm."><meta property="og:description" content="This constructor creates an eim S3 object, either by using matrices
X and W directly or by reading them from a JSON file. Each
eim object encapsulates the data (votes for candidates and demographic
groups) required by the underlying Expectation-Maximization algorithm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fastei</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="external-link nav-link" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4832834">Paper</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-functions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Functions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-functions"><li><a class="dropdown-item" href="../reference/run_em.html">run_em()</a></li>
    <li><a class="dropdown-item" href="../reference/bootstrap.html">bootstrap()</a></li>
    <li><a class="dropdown-item" href="../reference/simulate_election.html">simulate_election()</a></li>
    <li><a class="dropdown-item" href="../reference/get_agg_opt.html">get_agg_opt()</a></li>
    <li><a class="dropdown-item" href="../reference/get_agg_proxy.html">get_agg_proxy()</a></li>
    <li><a class="dropdown-item" href="../reference/welchtest.html">welchtest()</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Index</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DanielHermosilla/ecological-inference-elections/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>S3 Object for the Expectation-Maximization Algorithm</h1>
      <small class="dont-index">Source: <a href="https://github.com/DanielHermosilla/ecological-inference-elections/blob/HEAD/R/eim-class.R" class="external-link"><code>R/eim-class.R</code></a></small>
      <div class="d-none name"><code>eim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This constructor creates an <code>eim</code> S3 object, either by using matrices
<code>X</code> and <code>W</code> directly or by reading them from a JSON file. Each
<code>eim</code> object encapsulates the data (votes for candidates and demographic
groups) required by the underlying Expectation-Maximization algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eim</span><span class="op">(</span>X <span class="op">=</span> <span class="cn">NULL</span>, W <span class="op">=</span> <span class="cn">NULL</span>, json_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>(b x c)</code> matrix representing candidate votes per ballot box.</p></dd>


<dt id="arg-w">W<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A <code>(b x g)</code> matrix representing group votes per ballot box.</p></dd>


<dt id="arg-json-path">json_path<a class="anchor" aria-label="anchor" href="#arg-json-path"></a></dt>
<dd><p>A path to a JSON file containing <code>X</code> and <code>W</code> fields, stored as nested arrays. It may contain additional fields with other attributes, which will be added to the returned object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>eim</code> containing:</p><dl><dt><code>X</code></dt>
<dd><p>The candidate votes matrix <code>(b x c)</code>.</p></dd>

<dt><code>W</code></dt>
<dd><p>The group votes matrix <code>(b x g)</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>X</code> and <code>W</code> are directly supplied, they must match the
dimensions of ballot boxes <code>(b)</code>. Alternatively, if <code>json_path</code> is provided, the function expects
the JSON file to contain elements named <code>"X"</code> and <code>"W"</code> under the
top-level object. This two approaches are <strong>mutually exclusable</strong>, yielding an error otherwise.</p>
<p>Internally, this function also initializes the corresponding instance within
the low-level (C-based) API, ensuring the data is correctly registered for
further processing by the EM algorithm.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>A way to generate synthetic data for <code>X</code> and <code>W</code> is by using the <a href="simulate_election.html">simulate_election</a> function. See Example 2 below.</p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>


<p>In addition to this constructor, the "eim" class provides several
S3 methods for common operations. Some of these methods are fully documented,
while others are ommited due to its straightfoward implementantion. The available methods are:</p>
<ul><li><p><code><a href="run_em.html">run_em</a></code> – Runs the EM algorithm.</p></li>
<li><p><code><a href="bootstrap.html">bootstrap</a></code> – Estimates the standard deviation.</p></li>
<li><p><code><a href="save_eim.html">save_eim</a></code> – Saves the object to a file.</p></li>
<li><p><code><a href="get_agg_proxy.html">get_agg_proxy</a></code> – Estimates an ideal group aggregation given their standard deviations.</p></li>
<li><p><code><a href="get_agg_opt.html">get_agg_opt</a></code> – Estimates an ideal group aggregation among all combinations, given the log-likelihood.</p></li>
<li><p><code>print.eim</code> – Print info about the object.</p></li>
<li><p><code>summary.eim</code> – Summarize the object.</p></li>
<li><p><code>as.matrix.eim</code> – Returns the probability matrix.</p></li>
<li><p><code>logLik.eim</code> – Returns the final log‑likelihood.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Create an eim object from a JSON file</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu">eim</span><span class="op">(</span>json_path <span class="op">=</span> <span class="st">"path/to/file.json"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Use simulate_election with optional parameters, then create an eim object</span></span></span>
<span class="r-in"><span><span class="co"># from matrices</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data for 500 ballot boxes, 4 candidates and 5 groups</span></span></span>
<span class="r-in"><span><span class="va">sim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_election.html">simulate_election</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    num_ballots <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>    num_candidates <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    num_groups <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    group_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu">eim</span><span class="op">(</span>X <span class="op">=</span> <span class="va">sim_result</span><span class="op">$</span><span class="va">X</span>, W <span class="op">=</span> <span class="va">sim_result</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Create an object from a user defined matrix with 8 ballot boxes,</span></span></span>
<span class="r-in"><span><span class="co"># 2 candidates and 7 groups.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">57</span>, <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    <span class="fl">60</span>, <span class="fl">84</span>,</span></span>
<span class="r-in"><span>    <span class="fl">43</span>, <span class="fl">102</span>,</span></span>
<span class="r-in"><span>    <span class="fl">72</span>, <span class="fl">71</span>,</span></span>
<span class="r-in"><span>    <span class="fl">63</span>, <span class="fl">94</span>,</span></span>
<span class="r-in"><span>    <span class="fl">52</span>, <span class="fl">80</span>,</span></span>
<span class="r-in"><span>    <span class="fl">60</span>, <span class="fl">72</span>,</span></span>
<span class="r-in"><span>    <span class="fl">54</span>, <span class="fl">77</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">25</span>, <span class="fl">21</span>, <span class="fl">10</span>, <span class="fl">40</span>, <span class="fl">26</span>,</span></span>
<span class="r-in"><span>    <span class="fl">11</span>, <span class="fl">21</span>, <span class="fl">37</span>, <span class="fl">32</span>, <span class="fl">8</span>, <span class="fl">23</span>, <span class="fl">12</span>,</span></span>
<span class="r-in"><span>    <span class="fl">17</span>, <span class="fl">12</span>, <span class="fl">43</span>, <span class="fl">27</span>, <span class="fl">12</span>, <span class="fl">19</span>, <span class="fl">15</span>,</span></span>
<span class="r-in"><span>    <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">15</span>, <span class="fl">22</span>, <span class="fl">17</span>, <span class="fl">26</span>,</span></span>
<span class="r-in"><span>    <span class="fl">21</span>, <span class="fl">19</span>, <span class="fl">27</span>, <span class="fl">16</span>, <span class="fl">23</span>, <span class="fl">22</span>, <span class="fl">29</span>,</span></span>
<span class="r-in"><span>    <span class="fl">18</span>, <span class="fl">16</span>, <span class="fl">20</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">22</span>, <span class="fl">23</span>,</span></span>
<span class="r-in"><span>    <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">21</span>, <span class="fl">18</span>, <span class="fl">20</span>, <span class="fl">16</span>, <span class="fl">32</span>,</span></span>
<span class="r-in"><span>    <span class="fl">12</span>, <span class="fl">17</span>, <span class="fl">19</span>, <span class="fl">22</span>, <span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">28</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">7</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu">eim</span><span class="op">(</span>X <span class="op">=</span> <span class="va">x_mat</span>, W <span class="op">=</span> <span class="va">w_mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>fastei</p>
</div>

<div class="pkgdown-footer-right">
  <p>Developed by Daniel Hermosilla.</p>
</div>

    </footer></div>





  </body></html>

