<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>S3 Object for the Expectation-Maximization Algorithm — eim • fastei</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="S3 Object for the Expectation-Maximization Algorithm — eim"><meta property="og:description" content="This constructor creates an eim S3 object, either by using matrices
X and W directly or by reading them from a JSON file. Each
eim object encapsulates the data (votes for candidates and demographic groups) required by the underlying Expectation-Maximization algorithm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fastei</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/demonstration.html">Demonstration of the package usage</a>
    </li>
    <li>
      <a href="../articles/parametric.html">Using the parametric approach</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DanielHermosilla/ecological-inference-elections/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>S3 Object for the Expectation-Maximization Algorithm</h1>
    <small class="dont-index">Source: <a href="https://github.com/DanielHermosilla/ecological-inference-elections/blob/HEAD/R/eim-class.R" class="external-link"><code>R/eim-class.R</code></a></small>
    <div class="hidden name"><code>eim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This constructor creates an <code>eim</code> S3 object, either by using matrices
<code>X</code> and <code>W</code> directly or by reading them from a JSON file. Each
<code>eim</code> object encapsulates the data (votes for candidates and demographic groups) required by the underlying Expectation-Maximization algorithm.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eim</span><span class="op">(</span>X <span class="op">=</span> <span class="cn">NULL</span>, W <span class="op">=</span> <span class="cn">NULL</span>, V <span class="op">=</span> <span class="cn">NULL</span>, json_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code>(b x c)</code> matrix representing candidate votes per ballot box.</p></dd>


<dt id="arg-w">W<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A <code>(b x g)</code> matrix representing group votes per ballot box.</p></dd>


<dt id="arg-v">V<a class="anchor" aria-label="anchor" href="#arg-v"></a></dt>
<dd><p>Optional <code>(b x a)</code> matrix with the attributes for each ballot box. This is only used for parametric models.</p></dd>


<dt id="arg-json-path">json_path<a class="anchor" aria-label="anchor" href="#arg-json-path"></a></dt>
<dd><p>A path to a JSON file containing <code>X</code>, <code>W</code> (and optionally <code>V</code>) fields, stored as nested arrays. It may contain additional fields with other attributes, which will be added to the returned object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class <code>eim</code> containing:</p><dl><dt><code>X</code></dt>
<dd><p>The candidate votes matrix <code>(b x c)</code>.</p></dd>

<dt><code>W</code></dt>
<dd><p>The group votes matrix <code>(b x g)</code>.</p></dd>

<dt><code>V</code></dt>
<dd><p>The parametric covariates matrix <code>(b x a)</code>, when provided.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <code>X</code> and <code>W</code> are directly supplied, they must match the
dimensions of ballot boxes <code>(b)</code>. Alternatively, if <code>json_path</code> is provided, the function expects
the JSON file to contain elements named <code>"X"</code> and <code>"W"</code> (and optionally <code>"V"</code>) under the
top-level object. This two approaches are <strong>mutually exclusable</strong>, yielding an error otherwise.</p>
<p>When <code>V</code> is supplied, the object is treated as parametric and includes the <code>V</code> attribute.</p>
<p>Internally, this function also initializes the corresponding instance within
the low-level (C-based) API, ensuring the data is correctly registered for
further processing by the EM algorithm.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>A way to generate synthetic data for <code>X</code> and <code>W</code> is by using the <a href="simulate_election.html">simulate_election</a> function. See Example 2 below.
This constructor can be used for both non-parametric and parametric models (by providing <code>V</code>).</p>
    </div>
    <div id="methods">
    <h2>Methods</h2>


<p>In addition to this constructor, the "eim" class provides several
S3 methods for common operations. Some of these methods are fully documented,
while others are ommited due to its straightfoward implementantion. The available methods are:</p>
<ul><li><p><code><a href="run_em.html">run_em</a></code> - Runs the EM algorithm.</p></li>
<li><p><code><a href="bootstrap.html">bootstrap</a></code> - Estimates the standard deviation.</p></li>
<li><p><code><a href="save_eim.html">save_eim</a></code> - Saves the object to a file.</p></li>
<li><p><code><a href="get_agg_proxy.html">get_agg_proxy</a></code> - Estimates an ideal group aggregation given their standard deviations.</p></li>
<li><p><code><a href="get_agg_opt.html">get_agg_opt</a></code> - Estimates an ideal group aggregation among all combinations, given the log-likelihood.</p></li>
<li><p><code>print.eim</code> - Print info about the object.</p></li>
<li><p><code>summary.eim</code> - Summarize the object.</p></li>
<li><p><code>as.matrix.eim</code> - Returns the probability matrix.</p></li>
<li><p><code>logLik.eim</code> - Returns the final log-likelihood.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Create an eim object from a JSON file</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu">eim</span><span class="op">(</span>json_path <span class="op">=</span> <span class="st">"path/to/file.json"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Use simulate_election with optional parameters, then create an eim object</span></span></span>
<span class="r-in"><span><span class="co"># from matrices</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data for 500 ballot boxes, 4 candidates and 5 groups</span></span></span>
<span class="r-in"><span><span class="va">sim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_election.html">simulate_election</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    num_ballots <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>    num_candidates <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>    num_groups <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>    group_proportions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu">eim</span><span class="op">(</span>X <span class="op">=</span> <span class="va">sim_result</span><span class="op">$</span><span class="va">X</span>, W <span class="op">=</span> <span class="va">sim_result</span><span class="op">$</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Create an object from a user defined matrix with 8 ballot boxes,</span></span></span>
<span class="r-in"><span><span class="co"># 2 candidates and 7 groups.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">57</span>, <span class="fl">90</span>,</span></span>
<span class="r-in"><span>    <span class="fl">60</span>, <span class="fl">84</span>,</span></span>
<span class="r-in"><span>    <span class="fl">43</span>, <span class="fl">102</span>,</span></span>
<span class="r-in"><span>    <span class="fl">72</span>, <span class="fl">71</span>,</span></span>
<span class="r-in"><span>    <span class="fl">63</span>, <span class="fl">94</span>,</span></span>
<span class="r-in"><span>    <span class="fl">52</span>, <span class="fl">80</span>,</span></span>
<span class="r-in"><span>    <span class="fl">60</span>, <span class="fl">72</span>,</span></span>
<span class="r-in"><span>    <span class="fl">54</span>, <span class="fl">77</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">w_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">25</span>, <span class="fl">21</span>, <span class="fl">10</span>, <span class="fl">40</span>, <span class="fl">26</span>,</span></span>
<span class="r-in"><span>    <span class="fl">11</span>, <span class="fl">21</span>, <span class="fl">37</span>, <span class="fl">32</span>, <span class="fl">8</span>, <span class="fl">23</span>, <span class="fl">12</span>,</span></span>
<span class="r-in"><span>    <span class="fl">17</span>, <span class="fl">12</span>, <span class="fl">43</span>, <span class="fl">27</span>, <span class="fl">12</span>, <span class="fl">19</span>, <span class="fl">15</span>,</span></span>
<span class="r-in"><span>    <span class="fl">20</span>, <span class="fl">18</span>, <span class="fl">25</span>, <span class="fl">15</span>, <span class="fl">22</span>, <span class="fl">17</span>, <span class="fl">26</span>,</span></span>
<span class="r-in"><span>    <span class="fl">21</span>, <span class="fl">19</span>, <span class="fl">27</span>, <span class="fl">16</span>, <span class="fl">23</span>, <span class="fl">22</span>, <span class="fl">29</span>,</span></span>
<span class="r-in"><span>    <span class="fl">18</span>, <span class="fl">16</span>, <span class="fl">20</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">22</span>, <span class="fl">23</span>,</span></span>
<span class="r-in"><span>    <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">21</span>, <span class="fl">18</span>, <span class="fl">20</span>, <span class="fl">16</span>, <span class="fl">32</span>,</span></span>
<span class="r-in"><span>    <span class="fl">12</span>, <span class="fl">17</span>, <span class="fl">19</span>, <span class="fl">22</span>, <span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">28</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">7</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu">eim</span><span class="op">(</span>X <span class="op">=</span> <span class="va">x_mat</span>, W <span class="op">=</span> <span class="va">w_mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charles Thraves, Pablo Ubilla, Daniel Hermosilla.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

